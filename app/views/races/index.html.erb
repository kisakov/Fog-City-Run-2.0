<!DOCTYPE html>
<html>
<head>
  <title>Races</title> 
    <%= render "shared/navbar_races" %>
</head>
<body style="padding-top: 60px">
  <div class="container-fluid">
    <h2> Upcomming Races </h2>
    <table class="table table-hover table-bordered sortable">
      <thead>
      <tr>
        <th>Race</th>
        <th>Entries</th>
        <% if current_user and current_user.racer_id %>
        <th>Link</th>
        <% end %>
      </tr>
      </thead>
      <tbody>
      <% @upcomming_races_to_show.each do |race| %>
        <tr>
          <td><%= link_to race.date, race_path(race) %></td>
          <td><%= StartItem.where(race_id: race.id).count %></td>
          <% if current_user and current_user.racer_id %>
          <td><%= link_to 'Register', new_start_item_path(:race_id => race.id, :racer_id => current_user.racer_id), :class => "btn btn-default btn-xs" %></td>
          <% end %>
        </tr>
      <% end %>
      </tbody>
    </table>
    <h2> Past Races </h2>
    <table class="table table-hover table-bordered sortable">
      <thead>
      <tr>
        <th>Date</th>
        <th>Racer Count</th>
        <% if current_user and current_user.admin? %>
        <th>Actions</th>
        <% end %>
      </tr>
      </thead>
      <tbody>
      <% @races_to_show.each do |race| %>
        <tr>
          <td><%= link_to Race.find(race[0]).date, race_path(Race.find(race[0])) %></td>
          <td><%= race[1] %></td>
          <% if current_user and current_user.admin? %>
            <td><%= link_to 'Edit', race_path(Race.find(race[0])), :class => 'btn btn-default btn-xs' %> <%= link_to 'Destroy',
                  race_path(Race.find(race[0])), method: :delete, data: { confirm: 'Are you sure you want to delete ' + Race.find(race[0]).date.to_s + '?'  }, :class => 'btn btn-default btn-xs' %></td>
          <% end %>
        </tr>
      <% end %>
      </tbody>
    </table>
  </div>
</body>
</html>